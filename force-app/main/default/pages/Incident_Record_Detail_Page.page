<apex:page standardController="Incident_Record__c" extensions="incidentrecordApprovalExtension" >
<script src="/soap/ajax/24.0/connection.js" type="text/javascript"></script>
<script >
window.onload= function(){
        var statuspart='{!Incident_Record__c.Status_part__c}';
        //alert(statuspart);
        var RootCauseName='{!performRootCauseAnalysisName}';
        //alert(RootCauseName);
        if(RootCauseName!=null){
        var url = parent.location.href;
        var updateRecords = [];
        var RecordId='{!Incident_Record__c.Id}';
        
        var update_Lead = new sforce.SObject("Incident_Record__c");
        update_Lead.Id =RecordId;
        update_Lead.Root_Cause_Analysis_Site_Info__c='{!performRootCauseAnalysisName}';  
        update_Lead.Persons_who_translate_provide_follow_up__c='{!PersonswhotranslateName}';   
        if(statuspart=="0"){
        update_Lead.Status_part__c = "1";
        } 
        updateRecords.push(update_Lead);
        sforce.connection.sessionId = '{!$Api.Session_ID}';
        result = sforce.connection.update(updateRecords);
        //parent.location.href = url;
        }
    }
    var IncidentRecordId='{!Incident_Record__c.Id}';
    var siteInfoId='{!Incident_Record__c.Nexeo_Location_Associated_with_incident__c}';
    var createdbyemail='{!Incident_Record__c.CreatedBy.Email}';
    var PlanApprover='{!Incident_Record__c.Report_Plan_Approver_follow_up__r.Email}';
    //alert(PlanApprover);
    var corporateEmail='{!Incident_Record__c.Corporate_Environmental_Contact__c}';
    
    //var App=document.getElementById('ApproverName').value;
    
   function CorporateNotification() { 
    var AllApproverEmailId="";
    var IncidentSiteId='{!Incident_Record__c.Nexeo_Location_Associated_with_incident__c}';
    var FieldName="Yes";
    var EmailId;
    
    var QueryCorporateEmail= sforce.connection.query("SELECT User_Email_Id__c FROM User_GIR_Profile__c where Location__c ='"+IncidentSiteId+"'AND Send_me_Corporate_notifications__c='"+FieldName+"'");
    var ApproverEmailID= QueryCorporateEmail.getArray("records");
   
    for(var i=0;i<ApproverEmailID.length;i++){
        EmailId= ApproverEmailID[i].User_Email_Id__c;
        AllApproverEmailId=EmailId+";"+AllApproverEmailId; 
       
    }
    return AllApproverEmailId;   
}
    function ApproverDetails(FieldName) { 
    var AllApproverEmailId="";
    var AllApproverName="";
    var ApproverName;
    var EmailId;
    var QueryApprovarEmail= sforce.connection.query("SELECT Approver__r.Name,User_Email_Id__c FROM Incident_Approver__c where Site_Information__c ='"+siteInfoId+"'AND Division__c='"+FieldName+"'");
    var ApproverEmailID= QueryApprovarEmail.getArray("records");
   
    for(var i=0;i<ApproverEmailID.length;i++){
        EmailId= ApproverEmailID[i].User_Email_Id__c;
        AllApproverEmailId=EmailId+";"+AllApproverEmailId; 
        
        ApproverName= ApproverEmailID[i].Approver__r.Name; 
        AllApproverName=ApproverName+";"+AllApproverName;  
        
    }return AllApproverEmailId;   
}

    function NotifyEHSManagerNow(){
        var ApproverDet=ApproverDetails('EH&S Manager');
       var Approverback=ApproverDetails('EH&S Manager Backups');
       var Appr=ApproverDet+Approverback;
       if(Appr==""){
       alert("Please Select User for EH&S Manager/EH&S Manager Backups by clicking the New Incident Approver Button");
       }else{
        var TemplateName="Incident_Report_GIR_Completion_of_Incident_Details";
        var QueryResult= sforce.connection.query("select Id from EmailTemplate where developerName='"+TemplateName+"'");
        var RecordID= QueryResult.getArray("records");
        var TemplateId = RecordID[0].Id;
        
        var url = parent.location.href;
        var updateRecords = [];
        var RecordId='{!Incident_Record__c.Id}';
        
        var update_Lead = new sforce.SObject("Incident_Record__c");
        update_Lead.Id =RecordId;
        update_Lead.Edit_History_Status__c ='{!Incident_Record__c.Edit_History_Status__c}'+ "<br /> Escalating to serious incident";
        updateRecords.push(update_Lead);
        sforce.connection.sessionId = '{!$Api.Session_ID}';
        result = sforce.connection.update(updateRecords);
        //parent.location.href = url;
       
        location.replace('/email/author/emailauthor.jsp?retURL=%2F{!Incident_Record__c.Id}&p3_lkid={!Incident_Record__c.Id}&p24='+Appr+'&rtype=003&new_template=true&template_id='+TemplateId+'&save=1');
        }
       
    }
  function SendCorporateNotification(){
        var TemplateName="GIRCorporate_Incident_Priority";
        var QueryResult= sforce.connection.query("select Id from EmailTemplate where developerName='"+TemplateName+"'");
        var RecordID= QueryResult.getArray("records");
        var TemplateId = RecordID[0].Id;
        var CorporateEmailId=CorporateNotification();
        location.replace('/email/author/emailauthor.jsp?retURL=%2F{!Incident_Record__c.Id}&p3_lkid={!Incident_Record__c.Id}&p24='+CorporateEmailId+'&rtype=003&new_template=true&template_id='+TemplateId+'&save=1');
        
 } 
 
function SubmitIncidentReport(){  
   //alert("submit");
        var url = parent.location.href;
        var updateRecords = [];
        var RecordId='{!Incident_Record__c.Id}';
        
        var update_Lead = new sforce.SObject("Incident_Record__c");
        update_Lead.Id =RecordId;
        update_Lead.Status_part__c = "2";
        update_Lead.Status_part_info__c = "Requires Initial Incident Follow Up";
        update_Lead.Status_part_info2__c = "Requires Corporate Notification Sendoff (First Report)"; 
        update_Lead.Corporate_Approval__c = "Submitted";    
        updateRecords.push(update_Lead);
        sforce.connection.sessionId = '{!$Api.Session_ID}';
        result = sforce.connection.update(updateRecords);
        //alert(result);
        parent.location.href = url;
 }
 function ApproveInitialIncidentFollowUp(){

        var ApproverDet=ApproverDetails('Persons who can perform Root Cause Analysis');
        if(ApproverDet==""||PlanApprover==""){
        alert("Please Select User for Persons who can perform Root Cause Analysis and Report/Plan Approver by clicking the New Incident Approver Button below");
        }else{        
        var Incidenttype='{!CONTAINS( Incident_Record__c.Type_of_Incident__c , "Reliability")}';
        var ShortCircuit='{!Incident_Record__c.ShortCircuit__c}';
        var RootCause='{!Incident_Record__c.Is_Root_Cause_to_be_performed__c}';
        
       
        var TemplateName="GIR_Incident_Follow_up_Information_Entered";
        var TemplateName2="GIR_Assignment_to_do_RCA";
        var TemplateName3="GIR_Notification_Identify_Document_Corrective_Actions";
        
        var TemplateName1="GIR_Notification_Conduct_Document_RCA";
        var QueryResult1= sforce.connection.query("select Id from EmailTemplate where developerName='"+TemplateName1+"'");
        var RecordID1= QueryResult1.getArray("records");
        var TemplateId1 = RecordID1[0].Id;

        var QueryResult2= sforce.connection.query("select Id from EmailTemplate where developerName='"+TemplateName2+"'");
        var RecordID2= QueryResult2.getArray("records");
        var TemplateId2 = RecordID2[0].Id;
        
        var QueryResult3= sforce.connection.query("select Id from EmailTemplate where developerName='"+TemplateName3+"'");
        var RecordID3= QueryResult3.getArray("records");
        var TemplateId3 = RecordID3[0].Id;

        var url = parent.location.href;
        var updateRecords = [];
        var RecordId='{!Incident_Record__c.Id}';
        var update_Lead = new sforce.SObject("Incident_Record__c");
        update_Lead.Id =RecordId;     
       
        if(Incidenttype|| ShortCircuit!=1){
            
            
            if(RootCause=='Yes'){
            update_Lead.Status_part__c = "3.5";
            update_Lead.Status_part_info__c = "Requires Root Cause Analysis / Corrective Preventive Action";
                update_Lead.Edit_History_Status__c ='{!Incident_Record__c.Edit_History_Status__c}'+ "<br />Promoted to Part 3.5<br /> Sent RCA e-mail to "+'{!Incident_Record__c.Root_Cause_Analysis_Site_Info__c}';
            }else{
            update_Lead.Status_part__c = "4";
            update_Lead.Status_part_info__c = "Requires Final Report/ Plan Approval";
                update_Lead.Edit_History_Status__c ='{!Incident_Record__c.Edit_History_Status__c}'+ "<br />Promoted to Part 4<br />Sent Part 4 e-mail to"+'{!Incident_Record__c.Person_Responsible_for_Root_Cause__c}';
            }
        
        }

        if(ShortCircuit==1){
        update_Lead.Edit_History_Status__c = '{!Incident_Record__c.Edit_History_Status__c}'+ "<br />Promoted to Part 5";
        update_Lead.Status_part_info__c = "Requires Final Report Closure";
        update_Lead.Status_part__c = "4";
        }

        updateRecords.push(update_Lead);
        sforce.connection.sessionId = '{!$Api.Session_ID}';
        result = sforce.connection.update(updateRecords);
        //parent.location.href = url;


        Visualforce.remoting.Manager.invokeAction(
            '{!$RemoteAction.incidentrecordApprovalExtension.getSendingEmail}',
            createdbyemail,TemplateName,IncidentRecordId,
            function(result, event){
                //alert(event.type+"Error"+event.message);

            }, 
            {escape: true}
        );
        if(Incidenttype|| ShortCircuit!=1){
            if(RootCause=='Yes'){
                    Visualforce.remoting.Manager.invokeAction(
                        '{!$RemoteAction.incidentrecordApprovalExtension.getSendingEmail}',
                        PlanApprover,TemplateName1,IncidentRecordId,
                        function(result, event){
                            //alert(event.type+"Error"+event.message);
                        }, 
                        {escape: true}
                    );
                   //location.replace('/email/author/emailauthor.jsp?retURL=%2F{!Incident_Record__c.Id}&p3_lkid={!Incident_Record__c.Id}&p24={!Incident_Record__c.Report_Plan_Approver_follow_up__r.Email}&rtype=003&new_template=true&template_id='+TemplateId1+'&save=1'); 
                   location.replace('/email/author/emailauthor.jsp?retURL=%2F{!Incident_Record__c.Id}&p3_lkid={!Incident_Record__c.Id}&p24='+ApproverDet+'&rtype=003&new_template=true&template_id='+TemplateId2+'&save=1');
            }else{
                   location.replace('/email/author/emailauthor.jsp?retURL=%2F{!Incident_Record__c.Id}&p3_lkid={!Incident_Record__c.Id}&p24={!Incident_Record__c.Report_Plan_Approver_follow_up__r.Email}&rtype=003&new_template=true&template_id='+TemplateId3+'&save=1');
            }       
       }
       }
         
 }
function ApproveRootCauseAnalysisInformation(){
        var equipment='{!Incident_Record__c.equipment_involved_in_the_incident__c}';
        if(equipment==null){
            alert("Please enter Root Cause Analysis / Corrective-Preventive Actions section by edit this record");
        }else{    
        var ApproverDet=ApproverDetails('Persons who can perform Root Cause Analysis');
        if(ApproverDet==""||PlanApprover==""){
        alert("Please Select User for Persons who can perform Root Cause Analysis and Report/Plan Approver by clicking the New Incident Approver Button below");
        }else{ 
        var ShortCircuit='{!Incident_Record__c.ShortCircuit__c}';

        var TemplateName="GIR_Notification_Conduct_Document_RCA";
        var QueryResult= sforce.connection.query("select Id from EmailTemplate where developerName='"+TemplateName+"'");
        var RecordID= QueryResult.getArray("records");
        var TemplateId = RecordID[0].Id;
       
        var TemplateName1="GIR_Assignment_to_do_RCA";
        var QueryResult1= sforce.connection.query("select Id from EmailTemplate where developerName='"+TemplateName1+"'");
        var RecordID1= QueryResult1.getArray("records");
        var TemplateId1 = RecordID1[0].Id;

        var url = parent.location.href;
        var updateRecords = [];
        var RecordId='{!Incident_Record__c.Id}';
        var update_Lead = new sforce.SObject("Incident_Record__c");
        update_Lead.Id =RecordId;     
        
        if(ShortCircuit!=1){
        update_Lead.Status_part__c = "4";
        update_Lead.Status_part_info__c = "Requires Final Report/ Plan Approval";
        update_Lead.Edit_History_Status__c ='{!Incident_Record__c.Edit_History_Status__c}'+ "<br />Completed RCA Approval<br />Promoted to Part 4<br/>Sent RCA e-mail to "+'{!Incident_Record__c.Root_Cause_Analysis_Site_Info__c}';
        }

        if(ShortCircuit==1){
        update_Lead.Edit_History_Status__c = '{!Incident_Record__c.Edit_History_Status__c}'+ "<br />Completed RCA Approval<br />Promoted to Part 5";
        update_Lead.Status_part_info__c = "Requires Final Report Closure";
        update_Lead.Status_part__c = "5";
        }
                
        updateRecords.push(update_Lead);
        sforce.connection.sessionId = '{!$Api.Session_ID}';
        result = sforce.connection.update(updateRecords);

        parent.location.href = url;
        if(ShortCircuit!=1){
            Visualforce.remoting.Manager.invokeAction(
            '{!$RemoteAction.incidentrecordApprovalExtension.getSendingEmail}',
            PlanApprover,TemplateName,IncidentRecordId, 
            function(result, event){
                //alert(event.type+"Error"+event.message);

            }, 
            {escape: true}
            );
            //location.replace('/email/author/emailauthor.jsp?retURL=%2F{!Incident_Record__c.Id}&p3_lkid={!Incident_Record__c.Id}&rtype=003&new_template=true&p24={!Incident_Record__c.Report_Plan_Approver_follow_up__r.Email}&template_id='+TemplateId+'&save=1');
            location.replace('/email/author/emailauthor.jsp?retURL=%2F{!Incident_Record__c.Id}&p3_lkid={!Incident_Record__c.Id}&rtype=003&new_template=true&p24='+ApproverDet+'&template_id='+TemplateId1+'&save=1');
        }
        }
        }
 }

function ApproveFinalReportPlan(){    

        var equipment='{!Incident_Record__c.equipment_involved_in_the_incident__c}';
        var Incidenttype='{!CONTAINS( Incident_Record__c.Type_of_Incident__c , "Reliability")}';

        if(equipment==null){
            alert("Please enter Root Cause Analysis / Corrective-Preventive Actions section");
        }else{
        var TemplateName="GIR_Notification_Root_Cause_Completed_Posted";
       /* var QueryResult= sforce.connection.query("select Id from EmailTemplate where developerName='"+TemplateName+"'");
        var RecordID= QueryResult.getArray("records");
        var TemplateId = RecordID[0].Id;*/
       
        var TemplateName1="GIR_Reliability_Incident";
        var QueryResult1= sforce.connection.query("select Id from EmailTemplate where developerName='"+TemplateName1+"'");
        var RecordID1= QueryResult1.getArray("records");
        var TemplateId1 = RecordID1[0].Id;

        var url = parent.location.href;
        var updateRecords = [];
        var RecordId='{!Incident_Record__c.Id}';
        var update_Lead = new sforce.SObject("Incident_Record__c");
        update_Lead.Id =RecordId;    
        update_Lead.Status_part__c = "5";
        update_Lead.Status_part_info__c = "Requires Final Report Closure";
        
        if(Incidenttype){
            update_Lead.Edit_History_Status__c ='{!Incident_Record__c.Edit_History_Status__c}'+ "<br/>Promoted to Part 5<br/>Sent EHS RCA Notification<br/>Sent Reliability Email Notification";
        }else{
            update_Lead.Edit_History_Status__c ='{!Incident_Record__c.Edit_History_Status__c}'+ "<br/>Promoted to Part 5<br/>Sent EHS RCA Notification";
        }        
        updateRecords.push(update_Lead);
        sforce.connection.sessionId = '{!$Api.Session_ID}';
        result = sforce.connection.update(updateRecords);
        //parent.location.href = url;

        Visualforce.remoting.Manager.invokeAction(
            '{!$RemoteAction.incidentrecordApprovalExtension.getSendingEmail}',
            corporateEmail,TemplateName,IncidentRecordId, 
            function(result, event){
               // alert(event.type+"Error"+event.message);

            }, 
            {escape: true}
            );
        
            if(Incidenttype){
                location.replace('/email/author/emailauthor.jsp?retURL=%2F{!Incident_Record__c.Id}&p3_lkid={!Incident_Record__c.Id}&rtype=003&new_template=true&p24={!Incident_Record__c.Relibility_Contact_Name__r.Email}&template_id='+TemplateId1+'&save=1');
            }
        
        }
 }
 function CorporateNotificationSendoff(){

        var RIMlocation='{!Incident_Record__c.Site_RIM_Country__c}'
        //var type='{!Incident_Record__c.Type_of_Release_Spill__c}';
        var type1='{!CONTAINS( Incident_Record__c.Type_of_Release_Spill__c, "Federally/National/Provincial Reportable")}';
        var type2='{!CONTAINS( Incident_Record__c.Type_of_Release_Spill__c, "Local / State / Region Reportable")}';
        var IncidentType='{!Incident_Record__c.Date_Discovered__c}';
        var statuspart='{!Incident_Record__c.Status_part__c}';
        var RootCause='{!Incident_Record__c.Is_Root_Cause_to_be_performed__c}';
        var TemplateName="GIR_Notification_Environmental_Incident_Metric_Score_Approval_Needed";
        var QueryResult= sforce.connection.query("select Id from EmailTemplate where developerName='"+TemplateName+"'");
        var RecordID= QueryResult.getArray("records");        
        var TemplateId = RecordID[0].Id;
        
        var url = parent.location.href;
        var updateRecords = [];
        var RecordId='{!Incident_Record__c.Id}';
        var update_Lead = new sforce.SObject("Incident_Record__c");
        update_Lead.Id =RecordId;
        /*if(RootCause=='Yes'&& statuspart<=2){
            update_Lead.Status_part__c = "3.5";
        update_Lead.Status_part_info__c = "Requires Root Cause Analysis / Corrective Preventive Action";        
        update_Lead.Status_part_info2__c = "Corporate Notification Sent";
        }else if(statuspart<=2){
        update_Lead.Status_part__c = "4";
        update_Lead.Status_part_info__c = "Requires Final Report/ Plan Approval";        
        update_Lead.Status_part_info2__c = "Corporate Notification Sent";
        }else{*/
        update_Lead.Status_part_info2__c = "Corporate Notification Sent";
       // }        
        
        if(RIMlocation=='USA'){
        update_Lead.Date_OSHA__c=new Date();
        update_Lead.Completed_By__c='{!$User.FirstName} {!$User.LastName}';
        update_Lead.Edit_History_Status__c = '{!Incident_Record__c.Edit_History_Status__c}'+ "<br/>Completed SHE Mgr Approval<br/>Sent CorpEnv e-mail to "+'{!Incident_Record__c.Corporate_Environmental_Contact__c}'; 
        }else{
        update_Lead.Edit_History_Status__c = '{!Incident_Record__c.Edit_History_Status__c}'+ "<br/>Completed SHE Mgr Approval"; 
        }
        
        updateRecords.push(update_Lead);
        sforce.connection.sessionId = '{!$Api.Session_ID}';
        result = sforce.connection.update(updateRecords);
        parent.location.href = url;
        
       if((IncidentType !="")&&(type1||type2)){
         location.replace('/email/author/emailauthor.jsp?retURL=%2F{!Incident_Record__c.Id}&p3_lkid={!Incident_Record__c.Id}&rtype=003&new_template=true&p24={!Incident_Record__c.Corporate_Environmental_Contact__c}&template_id='+TemplateId+'&save=1');
       }
}
function ApproveFinalReportClosureInformation(){
     
        //var type='{!Incident_Record__c.Type_of_Release_Spill__c}';
        var Incidenttype='{!CONTAINS( Incident_Record__c.Type_of_Incident__c , "Release / Spill")}';
        var type1='{!CONTAINS( Incident_Record__c.Type_of_Release_Spill__c, "Federally/National/Provincial Reportable")}';
        var type2='{!CONTAINS( Incident_Record__c.Type_of_Release_Spill__c, "Local / State / Region Reportable")}';
        var TemplateName="GIR_Incident_Closed";
        var QueryResult= sforce.connection.query("select Id from EmailTemplate where developerName='"+TemplateName+"'");
        var RecordID= QueryResult.getArray("records");
        var TemplateId = RecordID[0].Id;
        
        var url = parent.location.href;
        var updateRecords = [];
        var RecordId='{!Incident_Record__c.Id}';
        var update_Lead = new sforce.SObject("Incident_Record__c");
        update_Lead.Id =RecordId;
        
        update_Lead.Actual_Approval_Date__c = new Date(); 
        update_Lead.Report_Approved_by__c = '{!$User.FirstName} {!$User.LastName}';  
        //update_Lead.Edit_History_Status__c = '{!Incident_Record__c.Edit_History_Status__c}'+ "<br/>Incident Closed pending CorpEnv Approval";
        //update_Lead.Edit_History_Status__c = '{!Incident_Record__c.Edit_History_Status__c}'+ "<br/>Incident Closed pending CorpEnv Approval<br/>Sent Incident Closed e-mail "+createdbyemail; 
        
        if((Incidenttype)&&(type1||type2)){
        update_Lead.Status_part_info__c = "Required Report Closed Pending CorpEnv Approval";
        update_Lead.Status_part__c = "6";
        update_Lead.Edit_History_Status__c = '{!Incident_Record__c.Edit_History_Status__c}'+ "<br/>Incident Closed pending CorpEnv Approval";
        }else{
        update_Lead.Edit_History_Status__c = '{!Incident_Record__c.Edit_History_Status__c}'+ "<br/>Incident Closed pending CorpEnv Approval<br/>Sent Incident Closed e-mail"+createdbyemail; 
        update_Lead.Status_part_info__c = "Report Closed";
        update_Lead.Status_part__c = "7";
        }
        
        updateRecords.push(update_Lead);
        sforce.connection.sessionId = '{!$Api.Session_ID}';
        result = sforce.connection.update(updateRecords);
        parent.location.href = url;
        if(NOT(Incidenttype)&&(type1||type2)){
           location.replace('/email/author/emailauthor.jsp?retURL=%2F{!Incident_Record__c.Id}&p3_lkid={!Incident_Record__c.Id}&p24='+createdbyemail+'&rtype=003&new_template=true&template_id='+TemplateId);      
        }   
 }
  function CorporateEnvironmentalApproval(){
         var ApprovelStatus='{!Incident_Record__c.Approval_Status__c}';
         var statuspart='{!Incident_Record__c.Status_part__c}';
         var Approvedby='{!Incident_Record__c.Approved_By__c}';
        if(ApprovelStatus=="Approved"){
        alert("This Record has been already approved by "+Approvedby);
        }else{
        var url = parent.location.href;
        var updateRecords = [];
        var RecordId='{!Incident_Record__c.Id}';
        
        var update_Lead = new sforce.SObject("Incident_Record__c");
        update_Lead.Id =RecordId;
        
        update_Lead.Approval_Status__c = "Approved";
        update_Lead.Approved_By__c = '{!$User.FirstName} {!$User.LastName}';
        update_Lead.Date_Approved__c = new Date();
        if(statuspart=="6"){
        update_Lead.Status_part__c = "7";
        }
        update_Lead.Corporate_Approval__c = "Approved";  
        update_Lead.Edit_History_Status__c = '{!Incident_Record__c.Edit_History_Status__c}'+ "<br/>Approved by CorpEnv";
        updateRecords.push(update_Lead);
        sforce.connection.sessionId = '{!$Api.Session_ID}';
        result = sforce.connection.update(updateRecords);
        parent.location.href = url;
        }
 }
  function ReSubmitCorporateEnvironmental(){
       
        var url = parent.location.href;
        var updateRecords = [];
        var RecordId='{!Incident_Record__c.Id}';
        
        var update_Lead = new sforce.SObject("Incident_Record__c");
        update_Lead.Id =RecordId;
       update_Lead.Edit_History_Status__c = '{!Incident_Record__c.Edit_History_Status__c}'+ "<br/>Resubmitted to CorpEnv";
        
        updateRecords.push(update_Lead);
        sforce.connection.sessionId = '{!$Api.Session_ID}';
        result = sforce.connection.update(updateRecords);
        parent.location.href = url;
        
 }
 function CorporateEnvironmentalRejection(){
        var ApproverDet=ApproverDetails('EH&S Manager');
       var Approverback=ApproverDetails('EH&S Manager Backups');
       var Appr=ApproverDet+Approverback;
       if(Appr==""){
       alert("Please Select User for EH&S Manager/EH&S Manager Backups by clicking the New Incident Approver Button below");
       }else{
        var TemplateName="GIR_Notification_Environmental_Incident_Metric_Score_Rejected";
        var QueryResult= sforce.connection.query("select Id from EmailTemplate where developerName='"+TemplateName+"'");
        var RecordID= QueryResult.getArray("records");
        var TemplateId = RecordID[0].Id;
        var url = parent.location.href;
        var updateRecords = [];
        var RecordId='{!Incident_Record__c.Id}';
        var update_Lead = new sforce.SObject("Incident_Record__c");
        
        update_Lead.Id =RecordId;
        //update_Lead.Edit_History_Status__c = '{!Incident_Record__c.Edit_History_Status__c}'+ "<br/>Rejected by CorpEnv"; 
        update_Lead.Edit_History_Status__c = '{!Incident_Record__c.Edit_History_Status__c}'+ "<br/>Rejected by CorpEnv<br/>Sent CorpEnv rejection e-mail to EH&S Manager and EH&S Manager BackUps"; 
        update_Lead.Corporate_Approval__c = "Rejected"; 
        updateRecords.push(update_Lead);
        sforce.connection.sessionId = '{!$Api.Session_ID}';
        result = sforce.connection.update(updateRecords);
        //parent.location.href = url;
        location.replace('/email/author/emailauthor.jsp?retURL=%2F{!Incident_Record__c.Id}&p3_lkid={!Incident_Record__c.Id}&p24='+Appr+'&rtype=003&new_template=true&template_id='+TemplateId+'&save=1');
        }
 }
     function AddRelibilitytotheIncident(){
        var ApproverDet=ApproverDetails('Persons who can perform Root Cause Analysis');
        var RelibilityContactName='{!Incident_Record__c.Relibility_Contact_Name__c}';
        if(RelibilityContactName==""){
        //alert("Please Select User for Persons who can perform Root Cause Analysis by clicking the New Incident Approver Button below");
        alert("Please Edit the record and fill the Relibility Incident Follow Up Section");
        }else{
        var TemplateName="GIR_Assignment_to_do_RCA";
        var QueryResult= sforce.connection.query("select Id from EmailTemplate where developerName='"+TemplateName+"'");
        var RecordID= QueryResult.getArray("records");
        var TemplateId = RecordID[0].Id;
        var url = parent.location.href;
        var updateRecords = [];
        var RecordId='{!Incident_Record__c.Id}';
        var update_Lead = new sforce.SObject("Incident_Record__c");
        update_Lead.Id =RecordId;
        update_Lead.Type_of_Incident__c = '{!Incident_Record__c.Type_of_Incident__c}' + "; Reliability"; 
        update_Lead.Edit_History_Status__c = '{!Incident_Record__c.Edit_History_Status__c}'+ "<br/>Sent RCA e-mail"; 
        updateRecords.push(update_Lead);
        sforce.connection.sessionId = '{!$Api.Session_ID}';
        result = sforce.connection.update(updateRecords);
        //parent.location.href = url;
        alert("It should give a prompt Reliability incident type has been added. This requires an RCA to be performed, but no one has yet been assigned to perform the RCA. Please fill in who should perform the RCA and notify them by e-mail yourself.System cannot notify RCA Responsible Person");
        location.replace('/email/author/emailauthor.jsp?retURL=%2F{!Incident_Record__c.Id}&p3_lkid={!Incident_Record__c.Id}&p24='+ApproverDet+'&rtype=003&new_template=true&template_id='+TemplateId+'&save=1');
        }
}
function OSHAReport(){
        var DocumentName="Blank_OSHA_Report_Template";
        var QueryResult= sforce.connection.query("select Id from Document where developerName='"+DocumentName+"'");
        var RecordID= QueryResult.getArray("records");
        var DocumentId = RecordID[0].Id;
        alert(DocumentId);
        location.replace('/servlet/servlet.FileDownload?file='+DocumentId);
    //location.replace('/apex/OSHA_Report?id='+IncidentRecordId);
}
function ExportOSHAReport(){
        location.replace('/apex/OSHA_Reports');
}
</script>
<apex:sectionHeader title="Incident Record" subtitle="{!Incident_Record__c.name}"/>

<apex:pageBlock title="Incident Record Detail">

<apex:pageBlockButtons location="top"> 
<apex:form >
                <apex:commandButton value="Edit" action="{!edit}" id="editButton" />
                <!--<apex:commandButton value="Cancel" action="{!cancel}" id="cancelButton" />-->
                <apex:commandButton value="Submit Incident Report" id="SubmitIncident" onclick=" return SubmitIncidentReport();" reRender="pageDetails" rendered="{!Incident_Record__c.Type_of_Incident__c != null && value(Incident_Record__c.Status_Part__c)<2}"/>
                <apex:commandButton value="Approve Initial Incident FollowUp" id="AppIniInc" onclick=" return ApproveInitialIncidentFollowUp();" reRender="pageDetails" rendered="{!(($User.Email=='ejriley@nexeosolutions.com' || CONTAINS(Personswhotranslate,$User.Email))&& Incident_Record__c.Status_part_info__c=='Requires Initial Incident Follow Up')}"/>
                <apex:commandButton value="Approve Root Cause Analysis/Corrective-Preventive Information" id="AppRootCau" onclick=" return ApproveRootCauseAnalysisInformation();" reRender="pageDetails" rendered="{!(($User.Email=='ejriley@nexeosolutions.com'|| CONTAINS(performRootCauseAnalysis,$User.Email))&& value(Incident_Record__c.Status_Part__c)>=3.5 && Incident_Record__c.Is_Root_Cause_to_be_performed__c=='Yes' && NOT(CONTAINS(Incident_Record__c.Edit_History_Status__c,'Completed RCA Approval')))}"/>
                <apex:commandButton value="Approve Final Report / Plan Approve Information" id="AppFinalRep" onclick=" return ApproveFinalReportPlan();" reRender="pageDetails" rendered="{!(($User.Email=='ejriley@nexeosolutions.com' || Incident_Record__c.Report_Plan_Approver_follow_up__r.Email==$User.Email) && Incident_Record__c.Status_part_info__c=='Requires Final Report/ Plan Approval')}"/>
                <apex:commandButton value="Approve Corporate Notification Sendoff (First Report) Information" id="CorNotiSend" onclick=" return CorporateNotificationSendoff();" reRender="pageDetail" rendered="{!(Incident_Record__c.Status_part_info2__c=="Requires Corporate Notification Sendoff (First Report)" && value(Incident_Record__c.Status_Part__c)>=2 &&(Incident_Record__c.Select_Person_For_Follow_Up__r.Email==$User.Email||Incident_Record__c.Report_Plan_Approver__r.Email == $User.Email || $User.Email=='ejriley@nexeosolutions.com'))}"/>
                <apex:commandButton value="Approve Final Report Closure Information" id="AppFinRe" onclick=" return ApproveFinalReportClosureInformation();" reRender="pageDetail" rendered="{!(($User.Email=='ejriley@nexeosolutions.com' || CONTAINS(finalizecloseincidents,$User.Email))&& Incident_Record__c.Status_part_info__c=='Requires Final Report Closure')}"/>
                <apex:commandButton value="Corporate Environmental Approval" id="CorEnvApp" onclick=" return CorporateEnvironmentalApproval();" reRender="pageDetail" rendered="{!(($User.Email==Incident_Record__c.Corporate_Environmental_Contact__c || $User.Email=='ejriley@nexeosolutions.com'))}"/>
                <apex:commandButton value="Corporate Environmental Rejection" id="CorEnvRej" onclick=" return CorporateEnvironmentalRejection();" reRender="pageDetail" rendered="{!(($User.Email==Incident_Record__c.Corporate_Environmental_Contact__c || $User.Email=='ejriley@nexeosolutions.com'))}"/>
                <apex:commandButton value="ReSubmit Corporate Environmental" id="CorEnvReSub" onclick=" return ReSubmitCorporateEnvironmental();" reRender="pageDetail" rendered="{!(($User.Email==Incident_Record__c.Corporate_Environmental_Contact__c || $User.Email=='ejriley@nexeosolutions.com')&& CONTAINS(Incident_Record__c.Edit_History_Status__c,'Rejected by CorpEnv'))}"/>
                <apex:commandButton value="Add Relibility to the Incident" id="AddRelIncid" onclick=" return AddRelibilitytotheIncident();" reRender="pageDetails" rendered="{!(Incident_Record__c.Status_Part__c=="5" && $User.Email=='ejriley@nexeosolutions.com')}"/>
                <apex:commandButton value="Send Corporate Notification" id="SentButton" onclick=" return SendCorporateNotification();" reRender="pageDetails" rendered="{!$User.Email=='ejriley@nexeosolutions.com'}"/>
                
                
</apex:form>
</apex:pageBlockButtons> 

<apex:outputpanel style="font-family:Times New Roman,Georgia,Serif;font-size:1.6em;color:#168FB6;font-weight: b" id="sec3">
<apex:outputLabel >{!Incident_Record__c.Status_part_info__c}</apex:outputLabel><br/>
<apex:outputLabel rendered="{!(0==0 && value(Incident_Record__c.Status_Part__c) >= 2)&& Incident_Record__c.Status_part_info2__c!='Corporate Notification Sent'}" >{!Incident_Record__c.Status_part_info2__c}</apex:outputLabel>
</apex:outputpanel>

<apex:pageBlockSection title="Initial Incident Information" columns="2">

<apex:outputText rendered="false" value="{!EHSManager}" />
<apex:outputText rendered="false" value="{!EHSManagerBackups}" />
<apex:outputText rendered="false" value="{!Personswhotranslate}" />
<apex:outputText rendered="false" value="{!initiateReliabilityIncident}" />
<apex:outputText rendered="false" value="{!performRootCauseAnalysis}" />
<apex:outputText rendered="false" value="{!finalizecloseincidents}" />
<apex:outputText rendered="false" value="{!SiteDistribution}" />
<apex:outputText rendered="false" value="{!performRootCauseAnalysisName}" />
<apex:outputText rendered="false" value="{!Incident_Record__c.Person_Responsible_for_performing_Root_C__r.Email}" />
<apex:outputText rendered="false" value="{!Incident_Record__c.Report_Plan_Approver_follow_up__r.Email}" />
<apex:outputText rendered="false" value="{!Incident_Record__c.Person_to_make_the_Final_Approval__r.Email}" />
<apex:outputText rendered="false" value="{!Incident_Record__c.Report_Plan_Approver__r.Email}" />
<apex:outputText rendered="false" value="{!Incident_Record__c.Relibility_Contact_Name__r.Email}" />
<apex:outputText rendered="false" value="{!Incident_Record__c.Select_Person_For_Follow_Up__r.Email}" />
<apex:outputText rendered="false" value="{!PersonswhotranslateName}" />


<apex:outputText title="name value" rendered="false" value="{!Incident_Record__c.Root_Cause_Analysis_Site_Info__c}" />
<apex:outputText title="name value" rendered="false" value="{!Incident_Record__c.Person_Responsible_for_Root_Cause__c }" />
<apex:outputText title="name value" rendered="false" value="{!Incident_Record__c.contact_name_email__c}" />
<apex:outputField title="Status Part" value="{!Incident_Record__c.Status_Part__c}"/>
<apex:outputField value="{!Incident_Record__c.priority__c}" rendered="{!$User.Email=='ejriley@nexeosolutions.com'}" />
<apex:outputField title="Time Ended" value="{!Incident_Record__c.Time_Ended__c}"/>
<apex:outputField title="Nexeo Location Associated with incident" value="{!Incident_Record__c.Nexeo_Location_Associated_with_incident__c}"/>
<apex:outputField title="Description" value="{!Incident_Record__c.Description__c}"/>
<apex:outputField title="If Off-Site, Location of Incident" value="{!Incident_Record__c.If_Off_Site_Location_of_Incident__c}"/>
<apex:outputField title="ECC Incident Log" value="{!Incident_Record__c.ECC_Incident_Log__c}"/>
<apex:outputField title="Incident Title" value="{!Incident_Record__c.Incident_Title__c}"/>
<apex:outputField title="Immediate Response Taken" value="{!Incident_Record__c.Immediate_Response_Taken__c}"/>
<apex:outputField title="Reported by" value="{!Incident_Record__c.Reported_by__c}"/>
<apex:outputField title="Type of Incident" value="{!Incident_Record__c.Type_of_Incident__c}">
<!--<apex:inlineEditSupport event="ondblClick"  showOnEdit="saveButton,cancelButton" hideOnEdit="editButton,SentButton,SubmitIncident,AppIniInc,AppRootCau,AppFinalRep,CorNotiSend,AppFinRe,CorEnvApp,CorEnvRej,CorEnvReSub,AddRelIncid" /> -->
</apex:outputField>
<apex:outputField title="Phone # of Reporter" value="{!Incident_Record__c.Phone_of_Reporter__c}"/>
<apex:outputField title="Was off-site emergency support requested" value="{!Incident_Record__c.Was_off_site_emergency_support_requested__c}"/>
<apex:outputField title="Incident Date" value="{!Incident_Record__c.Incident_Date__c}"/>
<apex:outputField label="Select Person For Follow Up" id="Personswhocaninitiatetranslateprovide" value="{!Incident_Record__c.Select_Person_For_Follow_Up__c}" />
<apex:outputField title="Did ECC become involved in incident?" value="{!Incident_Record__c.Did_ECC_become_involved_in_incident__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(Incident_Record__c.CreatedDate!=null)}" title="Incident Status Section" columns="2">
<apex:outputField title="Incident Record Id" value="{!Incident_Record__c.Name}"/>
<apex:outputField value="{!Incident_Record__c.CreatedDate}"/>
<apex:outputField value="{!Incident_Record__c.CreatedById}"/>
<apex:outputField title="Form Status" value="{!Incident_Record__c.Status_part_info__c}"/>
<apex:outputField title="Conduct Special Incident Tracking?" value="{!Incident_Record__c.Conduct_Special_Incident_Tracking__c}"/>
<apex:outputField title="Corporate Approval" value="{!Incident_Record__c.Corporate_Approval__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(0 == 0 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Adverse Health/Environmental Incident'))}" title="Fill in Additional Adverse Health/Environmental Incident Information Below." columns="2">
<apex:outputField title="Allegation Type" value="{!Incident_Record__c.Allegation_Type__c}"/>
<apex:outputField title="Name of person affected" value="{!Incident_Record__c.Name_of_person_affected__c}"/>
<apex:outputField title="Person Making Allegation" value="{!Incident_Record__c.Person_Making_Allegation__c}"/>
<apex:outputField title="Age of person affected" value="{!Incident_Record__c.Age_of_person_affected__c}"/>
<apex:outputField title="Details of person making allegation" value="{!Incident_Record__c.Details_of_person_making_allegation__c}"/>
<apex:outputField title="Sex of person affected" value="{!Incident_Record__c.Sex_of_person_affected__c}"/>
<apex:outputField title="Details on the type of effect" value="{!Incident_Record__c.Details_on_the_type_of_effect__c}"/>
<apex:outputField title="Who took the call (Nexeo Contact)" value="{!Incident_Record__c.Who_took_the_call_Nexeo_Contact__c}"/>
<apex:outputField title="Product or Process Implicated" value="{!Incident_Record__c.Product_or_Process_Implicated__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(value(Incident_Record__c.Status_Part__c) >= 2 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Adverse Health/Environmental Incident')&& Incident_Record__c.Title_Used_for_Corporate_Notification__c!=null)}" title="Adverse Health/Environmental Incident Follow up section" columns="2">
<apex:outputField title="Health Effects" value="{!Incident_Record__c.Health_Effects__c}"/>
<apex:outputField title="How Effects became known" value="{!Incident_Record__c.How_Effects_became_known__c}"/>
<apex:outputField title="Environmental Effects" value="{!Incident_Record__c.Environmental_Effects__c}"/>
<apex:outputField title="treatment provided to affected person?" value="{!Incident_Record__c.treatment_provided_to_affected_person__c}"/>
<apex:outputField title="Plants/Animals Affected" value="{!Incident_Record__c.Plants_Animals_Affected__c}"/>
<apex:outputField title="Health Care Provider Details" value="{!Incident_Record__c.Health_Care_Provider_Details__c}"/>
<apex:outputField title="Physical Part of Environment Affected" value="{!Incident_Record__c.Physical_Part_of_Environment_Affected__c}"/>
<apex:outputField title="Where was medical treatment provided?" value="{!Incident_Record__c.Where_was_medical_treatment_provided__c}"/>
<apex:outputField title="How Exposure Occurred" value="{!Incident_Record__c.How_Exposure_Occurred__c}"/>
<apex:outputField title="Additional Information to be supplied" value="{!Incident_Record__c.Additional_Information_to_be_supplied__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(value(Incident_Record__c.Status_Part__c) >= 2 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Adverse Health/Environmental Incident')&& Incident_Record__c.Title_Used_for_Corporate_Notification__c!=null )}" title="Corporate Regulatory Affairs Analysis" columns="2">
<apex:outputField title="Type of TSCA incident" value="{!Incident_Record__c.Type_of_TSCA_incident__c}"/>
<apex:outputField title="Is Corporate analysis complete?" value="{!Incident_Record__c.Is_Corporate_analysis_complete__c}"/>
<apex:outputField title="Reason for Classification" value="{!Incident_Record__c.Reason_for_Classification__c}"/>
<apex:outputField title="Other RA Comments" value="{!Incident_Record__c.Other_RA_Comments__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(0 == 0 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Agency Inspection/Visit'))}" title="Agency Inspection/Visit" columns="2">
<apex:outputField title="Name of Visiting Authorities" value="{!Incident_Record__c.Name_of_Visiting_Authorities__c}"/>
<apex:outputField title="Topic of Visit" value="{!Incident_Record__c.Topic_of_Visit__c}"/>
<apex:outputField title="Name of Agency" value="{!Incident_Record__c.Name_of_Agency__c}"/>
<apex:outputField title="Any Violations/Nonconformance Alleged" value="{!Incident_Record__c.Any_Violations_Nonconformance_Alleged__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(0 == 0 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Business Interruption'))}" title="Fill in Business Interruption Additional Information Below" columns="2">
<apex:outputField title="Interruption Type" value="{!Incident_Record__c.Interruption_Type__c}"/>
<apex:outputField title="Downtime Expected" value="{!Incident_Record__c.Downtime_Expected__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(value(Incident_Record__c.Status_Part__c) >= 2 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Business Interruption') && Incident_Record__c.Title_Used_for_Corporate_Notification__c!=null)}" title="Business Inturruption Incident Follow Up" columns="2">
<apex:outputField title="Approximate Downtime (Hours)" value="{!Incident_Record__c.Approximate_Downtime_Hours__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(0 == 0 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'External Complaint'))}" title="Fill in External Complaint Additional Information Below" columns="2">
<apex:outputField title="Type of Complaint" value="{!Incident_Record__c.Type_of_Complaint__c}"/>
<apex:outputField title="Company of person with complaint" value="{!Incident_Record__c.Company_of_person_with_complaint__c}"/>
<apex:outputField title="Name of Person with Complaint/Agency" value="{!Incident_Record__c.Name_of_Person_with_Complaint_Agency__c}"/>
<apex:outputField title="What or who was affected by complaint?" value="{!Incident_Record__c.What_or_who_was_affected_by_complaint__c}"/>
<apex:outputField title="Phone Number of Person with Complaint" value="{!Incident_Record__c.Phone_Number_of_Person_with_Complaint__c}"/>
<apex:outputField title="Ask for other Witnesses/involved parties" value="{!Incident_Record__c.Ask_for_other_Witnesses_involved_parties__c}"/>
<apex:outputField title="Street address of Person with Complaint" value="{!Incident_Record__c.Street_address_of_Person_with_Complaint__c}"/>
<apex:outputField title="Any treatment given/illnesses reported" value="{!Incident_Record__c.Any_treatment_given_illnesses_reported__c}"/>
<apex:outputField title="City of Person with Complaint" value="{!Incident_Record__c.City_of_Person_with_Complaint__c}"/>
<apex:outputField title="What did you tell Person with Complaint?" value="{!Incident_Record__c.What_did_you_tell_Person_with_Complaint__c}"/>
<apex:outputField title="State of Person with Complaint" value="{!Incident_Record__c.State_of_Person_with_Complaint__c}"/>
<apex:outputField title="Findnigs for complaints" value="{!Incident_Record__c.Findnigs_for_complaints__c}"/>
<apex:outputField title="Zip code of Person with Complaint" value="{!Incident_Record__c.Zip_code_of_Person_with_Complaint__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(0 == 0 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Fire/Explosion/OverPressure'))}" title="Fill in Fire / Exlosion / OverPressure Additional Information Below" columns="2">
<apex:outputField title="Fire / Explosion / Overpressure Type" value="{!Incident_Record__c.Fire_Explosion_Overpressure_Type__c}"/>
<apex:outputField title="How was Fire Detected" value="{!Incident_Record__c.How_was_Fire_Detected__c}"/>
<apex:outputField title="Area of Origin" value="{!Incident_Record__c.Area_of_Origin__c}"/>
<apex:outputField title="Names of Ashland Employees who participated in Suppression Actions" value="{!Incident_Record__c.Emp_who_participated_in_Suppression__c}"/>
<apex:outputField title="Equipment of Origin" value="{!Incident_Record__c.Equipment_of_Origin__c}"/>
<apex:outputField title="Method of Extinguisher Equipment" value="{!Incident_Record__c.Method_of_Extinguisher_Equipment__c}"/>
<apex:outputField title="Form of Heat Ignition" value="{!Incident_Record__c.Form_of_Heat_Ignition__c}"/>
<apex:outputField title="Plant Alarm System Activated" value="{!Incident_Record__c.Plant_Alarm_System_Activated__c}"/>
<apex:outputField title="Type of Material First Ignited" value="{!Incident_Record__c.Type_of_Material_First_Ignited__c}"/>
<apex:outputField title="Fire caused by a material/chemical proce" value="{!Incident_Record__c.Fire_caused_by_a_material_chemical_proce__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(value(Incident_Record__c.Status_Part__c) >= 2 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Fire/Explosion/OverPressure')&& Incident_Record__c.Title_Used_for_Corporate_Notification__c!=null)}" title="Fire/Explosion Incident Follow Up" columns="2">
<apex:outputField title="Ashland Fire Classification" value="{!Incident_Record__c.Ashland_Fire_Classification__c}"/>
<apex:outputField title="Type of Container" value="{!Incident_Record__c.Type_of_Container__c}"/>
<apex:outputField title="Is the incident with a customer waste?" value="{!Incident_Record__c.Is_the_incident_with_a_customer_waste__c}"/>
<apex:outputField title="Describe other container type" value="{!Incident_Record__c.Describe_other_container_type__c}"/>
<apex:outputField title="Waste generator's name" value="{!Incident_Record__c.Waste_generator_s_name__c}"/>
<apex:outputField title="Type of material/waste" value="{!Incident_Record__c.Type_of_material_waste__c}"/>
<apex:outputField title="Location of origin" value="{!Incident_Record__c.Location_of_origin__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(0 == 0 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Injury/Illness/Just Reporting'))}" title="Fill in Injury/Illness Additional Information Below" columns="2">
<apex:outputField title="injuries associated with this incident?" value="{!Incident_Record__c.injuries_associated_with_this_incident__c}"/>
<apex:outputField title="Name of injured employee" value="{!Incident_Record__c.Name_of_injured_employee__c}"/>
<apex:outputField title="Is this only 'Medical Just Reporting'" value="{!Incident_Record__c.Is_this_only_Medical_Just_Reporting__c}"/>
<apex:outputField title="Witnessess and other involved parties" value="{!Incident_Record__c.Witnessess_and_other_involved_parties__c}"/>
<apex:outputField title="Elements associated with this Incident" value="{!Incident_Record__c.Elements_associated_with_this_Incident__c}"/>
<apex:outputField title="Nature of injury/illness" value="{!Incident_Record__c.Nature_of_injury_illness__c}"/>
<apex:outputField title="Was this injury to a Nexeo Employee?" value="{!Incident_Record__c.Was_this_injury_to_a_Nexeo_Employee__c}"/>
<apex:outputField title="Treatment if known (or enter 'None')" value="{!Incident_Record__c.Treatment_if_known_or_enter_None__c}"/>
<apex:outputField title="offsite personnel perform any treatment?" value="{!Incident_Record__c.offsite_personnel_perform_any_treatment__c}"/>
<apex:outputField title="injury related to a loss of containment" value="{!Incident_Record__c.injury_related_to_a_loss_of_containment__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(value(Incident_Record__c.Status_Part__c) >= 2 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Injury/Illness/Just Reporting')&& Incident_Record__c.Title_Used_for_Corporate_Notification__c!=null)}" title="Injury/Illness Incident Followup" columns="2">
<apex:outputField title="injured person under our direct supervis" value="{!Incident_Record__c.injured_person_under_our_direct_supervis__c}"/>
<apex:outputField title="Treatment Classification" value="{!Incident_Record__c.Treatment_Classification__c}"/>
<apex:outputField title="Classification of injury" value="{!Incident_Record__c.Classification_of_injury__c}"/>
<apex:outputField title="Describe Medical Treatment Given" value="{!Incident_Record__c.Describe_Medical_Treatment_Given__c}"/>
<apex:outputField title="Job Title of Injured Employee" value="{!Incident_Record__c.Job_Title_of_Injured_Employee__c}"/>
<apex:outputField title="Body part Code Affected" value="{!Incident_Record__c.Body_part_Code_Affected__c}"/>
<apex:outputField title="sensitive injury/prohibited to displayed" value="{!Incident_Record__c.sensitive_injury_prohibited_to_displayed__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(value(Incident_Record__c.Status_Part__c) >= 2 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Injury/Illness/Just Reporting') && Incident_Record__c.Title_Used_for_Corporate_Notification__c!=null)}" title="Additional Injury Incident Followup" columns="2">
<apex:outputField title="Date Restricted or Away Start" value="{!Incident_Record__c.Date_Restricted_or_Away_Start__c}"/>
<apex:outputField title="Are Days Restricted and Days away from" value="{!Incident_Record__c.Are_Days_Restricted_and_Days_away_from__c}"/>
<apex:outputField title="Date Returned to Unrestricted Work" value="{!Incident_Record__c.Date_Returned_to_Unrestricted_Work__c}"/>
<apex:outputField title="Disability Status" value="{!Incident_Record__c.Disability_Status__c}"/>
<apex:outputField title="Days of Job Transfer or Restricted" value="{!Incident_Record__c.Days_of_Job_Transfer_or_Restricted__c}"/>
<apex:outputField title="Days Away from Work" value="{!Incident_Record__c.Days_Away_from_Work__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(0 == 0 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Material/Property Equipment Damage or Loss'))}" title="Fill in Material/Property Equipment Damage or Loss Additional information Below" columns="2">
<apex:outputField title="Describe all Damage" value="{!Incident_Record__c.Describe_all_Damage__c}"/>
<apex:outputField title="Weather Type" value="{!Incident_Record__c.Weather_Type__c}"/>
<apex:outputField title="Was the incident weather related?" value="{!Incident_Record__c.Was_the_incident_weather_related__c}"/>
<apex:outputField title="Individuals involved" value="{!Incident_Record__c.Individuals_involved__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(0 == 0 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Motor Vehicle Accident'))}" title="Fill in Motor Vehicle Accident Additional Information Below" columns="2">
<apex:outputField title="Type of Motor Vehicle Accident" value="{!Incident_Record__c.Type_of_Motor_Vehicle_Accident__c}"/>
<apex:outputField title="Was a citation issued?" value="{!Incident_Record__c.Was_a_citation_issued__c}"/>
<apex:outputField title="Ashland Employee Involved In Accident" value="{!Incident_Record__c.Ashland_Employee_Involved_In_Accident__c}"/>
<apex:outputField title="Vehicle Ownership" value="{!Incident_Record__c.Vehicle_Ownership__c}"/>
<apex:outputField title="Vehicle Type" value="{!Incident_Record__c.Vehicle_Type__c}"/>
<apex:outputField title="Names of other parties involved" value="{!Incident_Record__c.Names_of_other_parties_involved__c}"/>
<apex:outputField title="Was the accident preventable?" value="{!Incident_Record__c.Was_the_accident_preventable__c}"/>
<apex:outputField title="Location of Accident" value="{!Incident_Record__c.Location_of_Accident__c}"/>
<apex:outputField title="were any of the vehicles involved?" value="{!Incident_Record__c.were_any_of_the_vehicles_involved__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(0 == 0 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Motor Vehicle Accident'))}" title="Commercial Motor Vehicle information" columns="2">
<apex:outputField title="All outcomes from this Vehicle Accident" value="{!Incident_Record__c.All_outcomes_from_this_Vehicle_Accident__c}"/>
<apex:outputField title="Was there a release of a marine pollutant in a quantity exceeded 119 gallons if liquid or 882 pounds if solid?" value="{!Incident_Record__c.Was_there_a_release_of_a_marine_pollutan__c}"/>
<apex:outputField title="Direct result of a Hazardous Material?" value="{!Incident_Record__c.Direct_result_of_a_Hazardous_Material__c}"/>
<apex:outputField title="Was the vehicle (1) a tank truck, (2) greater than 1000 gallons, (3) transporting a hazardous material, and (4) received damage to any associated containment, piping, valves, esc. that require repair" value="{!Incident_Record__c.Was_the_vehicle_1_a_tank_truck__c}"/>
<apex:outputField title="Did this incident involve the release of a transported chemical?" value="{!Incident_Record__c.Did_this_incident_involve_the_release__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(0 == 0 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Motor Vehicle Accident'))}" title="This incident involved a commercial motor vehicle and has likely triggred" columns="2">
<apex:outputField title="Regulatory Substance Abuse Testing: Was testing Done?" value="{!Incident_Record__c.Regulatory_Substance_Abuse_Testing__c}"/>
<apex:outputField title="DOT Form F 5800.1: was report filled?" value="{!Incident_Record__c.DOT_Form_F_5800_1_was_report_filled__c}"/>
<apex:outputField title="DOT Telephonic Reporting: Was Reporting Done?" value="{!Incident_Record__c.DOT_Telephonic_Reporting__c}"/>
<apex:outputField title="Comments" value="{!Incident_Record__c.Comments__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(value(Incident_Record__c.Status_Part__c) >= 2 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Motor Vehicle Accident')&& Incident_Record__c.Title_Used_for_Corporate_Notification__c!=null)}" title="Motor Vehicle Accident Incident Follow Up" columns="2">
<apex:outputField title="Did the accident involve a nonconformance with the Ashland Motor Vehicle Accident Prevention Policy?" value="{!Incident_Record__c.Did_the_accident_involve_a_nonconformanc__c}"/>
<apex:outputField title="Describe any nonconformance with policy" value="{!Incident_Record__c.Describe_any_nonconformance_with_policy__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(0 == 0 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Near Incident/Unsafe Condition/Concern'))}" title="Fill in Near Incident/Unsafe Condition/Concern Additional Information Below" columns="2">
<apex:outputField title="Choose" value="{!Incident_Record__c.Choose__c}"/>
<apex:outputField title="Is a contingency plan on file?" value="{!Incident_Record__c.Is_a_contingency_plan_on_file__c}"/>
<apex:outputField title="Type of near incident/condition" value="{!Incident_Record__c.Type_of_near_incident_condition__c}"/>
<apex:outputField title="Type of impairment?" value="{!Incident_Record__c.Type_of_impairment__c}"/>
<apex:outputField title="Witnesses and other involved parties" value="{!Incident_Record__c.Con_Witnesses_and_other_involved_parties__c}"/>
<apex:outputField title="Date impairment is eliminated" value="{!Incident_Record__c.Date_impairment_is_eliminated__c}"/>
<apex:outputField title="considered to reduce risks?" value="{!Incident_Record__c.considered_to_reduce_risks__c}"/>
<apex:outputField title="Eliminated date impairment" value="{!Incident_Record__c.Eliminated_date_impairment__c}"/>
<apex:outputField title="Is this a fire impairment?" value="{!Incident_Record__c.Is_this_a_fire_impairment__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(0 == 0 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Non Conformance/Violation'))}" title="Fill in Non Conformance/Violation Additional Information Below" columns="2">
<apex:outputField title="Type of nonconformance" value="{!Incident_Record__c.Type_of_nonconformance__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(value(Incident_Record__c.Status_Part__c) >= 2 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Non Conformance/Violation')&& Incident_Record__c.Title_Used_for_Corporate_Notification__c!=null)}" title="EH&S Non Conformance / Violation Follow Up." columns="2">
<apex:outputField title="Category of Non-conformance/Violation" value="{!Incident_Record__c.Category_of_Non_conformance_Violation__c}"/>
<apex:outputField title="facility issued a notice of violation?" value="{!Incident_Record__c.facility_issued_a_notice_of_violation__c}"/>
<apex:outputField title="Category" value="{!Incident_Record__c.Non_Conformance_Category__c}"/>
<apex:outputField title="Facility entered a compliance agreemnt?" value="{!Incident_Record__c.Facility_entered_a_compliance_agreemnt__c}"/>
<apex:outputField title="Subject Matter Expert" value="{!Incident_Record__c.Subject_Matter_Expert__c}"/>
<apex:outputField title="Date of NOV Issue" value="{!Incident_Record__c.Date_of_NOV_Issue__c}"/>
<apex:outputField title="EH&S Program" value="{!Incident_Record__c.EH_S_Program__c}"/>
<apex:outputField title="Date Nonconformance/Violation Eliminated" value="{!Incident_Record__c.Date_Nonconformance_Violation_Eliminated__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(0 == 0 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Release/Spill'))}" title="Fill in Release/Spill Additional Information Below" columns="2">
<apex:outputField title="Date Discovered" value="{!Incident_Record__c.Date_Discovered__c}"/>
<apex:outputField title="Incident meet the diminished release?" value="{!Incident_Record__c.Incident_meet_the_diminished_release__c}"/>
<apex:outputField title="Type of Release / Spill" value="{!Incident_Record__c.Type_of_Release_Spill__c}"/>
<apex:outputField title="Flammable or Toxic Vapor Cloud?" value="{!Incident_Record__c.Flammable_or_Toxic_Vapor_Cloud__c}"/>
<apex:outputField title="Extent of Release" value="{!Incident_Record__c.Extent_of_Release__c}"/>
<apex:outputField title="Container type where material" value="{!Incident_Record__c.Container_type_where_material__c}"/>
<apex:outputField title="Date Release Cleanup completed" value="{!Incident_Record__c.Date_Release_Cleanup_completed__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(0 == 0 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Release/Spill'))}" title="Material Released" columns="2">
<apex:outputField title="Units used in release information" value="{!Incident_Record__c.Units_used_in_release_information__c}"/>
<apex:outputField title="Estimated Total amt of released material" value="{!Incident_Record__c.Estimated_Total_amt_of_released_material__c}"/>
<apex:outputField title="Describe released / spilled materials" value="{!Incident_Record__c.Describe_released_spilled_materials__c}"/>
<!--<apex:outputField title="components released that have flammable?" value="{!Incident_Record__c.components_released_that_have_flammable__c}"/>-->
<!--<apex:relatedList list="Spill_Release_Details__r"/>-->
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(0 == 0 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Security'))}" title="Fill in Security Incident Additional Information Below" columns="2">
<apex:outputField title="Alleged Incident Type(s)" value="{!Incident_Record__c.Alleged_Incident_Type_s__c}"/>
<apex:outputField title="Other Incident Type" value="{!Incident_Record__c.Other_Incident_Type__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(Incident_Record__c.Type_of_Incident__c != null && Incident_Record__c.Title_Used_for_Corporate_Notification__c!=null && value(Incident_Record__c.Status_Part__c) >= 2)}" title="Incident Follow Up Continued" columns="2">
<apex:outputField title="Title Used for Corporate Notification" value="{!Incident_Record__c.Title_Used_for_Corporate_Notification__c}"/>
<apex:outputField title="Initial Description Summary of Incident" value="{!Incident_Record__c.Initial_Description_Summary_of_Incident__c}"/>
<apex:outputField title="Name Witnesses (or enter 'N/A')" value="{!Incident_Record__c.Name_Witnesses_or_enter_N_A__c}"/>
<apex:outputField title="Person Responsible for Root Cause" value="{!Incident_Record__c.Person_Responsible_for_Root_Cause__c}"/>
<apex:form >
<apex:commandButton value="Notify EH&S Manager Now" onfocus="This incident has not been determined to be serious enough to notify the EHS Manager. If you wish to notify him/her regardless, please press the Notify EHS Manager Now button" alt="This incident has not been determined to be serious enough to notify the EHS Manager. If you wish to notify him/her regardless, please press the Notify EHS Manager Now button" id="NotifyEHS" onclick=" return NotifyEHSManagerNow();" reRender="pageDetails" rendered="{!Incident_Record__c.Is_this_incident_related_to_onsite__c=='Yes'}"/>
</apex:form>
<apex:outputField title="Is this incident related to onsite?" value="{!Incident_Record__c.Is_this_incident_related_to_onsite__c}"/>
<apex:outputField title="Outside Parties Involved" value="{!Incident_Record__c.Outside_Parties_Involved__c}"/>
<apex:outputField title="Was this event a catastrophic incident" value="{!Incident_Record__c.Was_this_event_a_catastrophic_incident__c}"/>
<apex:outputField title="Describe offsite emergency response" value="{!Incident_Record__c.Describe_offsite_emergency_response__c}"/>
<apex:outputField title="Describe Off-Site Consequences" value="{!Incident_Record__c.Describe_Off_Site_Consequences__c}"/>
<apex:outputField title="Is Root Cause to be performed?" value="{!Incident_Record__c.Is_Root_Cause_to_be_performed__c}"/>
<apex:outputField label="Person Responsible for performing Root Cause" id="PersonswhocanperformRootCause" rendered="{!Incident_Record__c.Is_Root_Cause_to_be_performed__c=='Yes'}" value="{!Incident_Record__c.Person_Responsible_for_performing_Root_C__c}"/>
<apex:outputField label="Select the Report/Plan Approver" id="Personswhocanfinalize" value="{!Incident_Record__c.Report_Plan_Approver_follow_up__c}"/>
<apex:outputField label="Identify Person to make the Final Approval of this Incident Closure" id="Personswhocanfinalize2"  value="{!Incident_Record__c.Person_to_make_the_Final_Approval__c}"/>
<apex:outputField title="External Telephone Notifications Made?" value="{!Incident_Record__c.External_Telephone_Notifications_Made__c}"/>
<apex:relatedList list="Telephone_Notifications__r" rendered="{!Incident_Record__c.External_Telephone_Notifications_Made__c=='Yes'}"/>
<apex:outputField title="Indicate cleanup / remediation" value="{!Incident_Record__c.Indicate_cleanup_remediation__c}"/>

<apex:outputField title="Report/Plan Approver" value="{!Incident_Record__c.Report_Plan_Approver_new__c}" rendered="false"/>
<apex:outputField title="Media coverage associate with this event" value="{!Incident_Record__c.Media_coverage_associate_with_this_event__c}"/>
<apex:outputField title="Indicate offsite impact" value="{!Incident_Record__c.Indicate_offsite_impact__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(Incident_Record__c.Type_of_Incident__c != null && Incident_Record__c.Notify_Corporate_Distribution__c!=null && value(Incident_Record__c.Status_Part__c) >= 2)}" title="Corporate Notification Send Off (First Report)" columns="2">
<apex:outputField title="Notify Corporate Distribution?" value="{!Incident_Record__c.Notify_Corporate_Distribution__c}"/>
<apex:outputField label="Select the Report/Plan Approver" id="Personswhocanfinalize3" value="{!Incident_Record__c.Report_Plan_Approver__c}"/>
<apex:outputField title="Incident associated wit Chemical Process" value="{!Incident_Record__c.Incident_associated_wit_Chemical_Process__c}"/>
<apex:outputField title="reporting quantity can be released?" value="{!Incident_Record__c.reporting_quantity_can_be_released__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(Incident_Record__c.Type_of_Incident__c != null && Incident_Record__c.Incident_associated_wit_Chemical_Process__c == 'Yes' && $Profile.Name=='Plant Manager Platform' && $User.Email==Incident_Record__c.Corporate_Environmental_Contact__c && $User.Email==Incident_Record__c.Corporate_Safety_Contact__c)}" title="Old ACC Metric" columns="2">

<apex:outputField title="Is the incident a serious injury?" value="{!Incident_Record__c.Is_the_incident_a_serious_injury__c}"/>
<apex:outputField title="Is the incident a Fire/Explosion and Cost of repairs > $25,000 USD?" value="{!Incident_Record__c.Fire_Explosion_and_cost_of_repairs__c}"/>
<!--<apex:outputText label="Is the quantity of chemical released?" value="{!chemical}"/>-->
<!--<apex:outputText label="Is the quantity of flammable components released at or over 5,000 lbs?" value=""/>-->
<!--<apex:outputText rendered="{!(Incident_Record__c.Is_the_incident_a_serious_injury__c == 'Yes'|| Incident_Record__c.Fire_Explosion_and_cost_of_repairs__c == 'Yes'||chemical=='Yes'||flam=='Yes')}"   label="ACC Reportable due to Injury or Material" value="Yes"/>-->
<!--<apex:outputText rendered="{!NOT(Incident_Record__c.Is_the_incident_a_serious_injury__c == 'Yes'|| Incident_Record__c.Fire_Explosion_and_cost_of_repairs__c == 'Yes'||chemical=='Yes'||flam =='Yes')}"   label="ACC Reportable due to Injury or Material" value="Yes"/>-->

</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(Incident_Record__c.Type_of_Incident__c != null && Incident_Record__c.Incident_associated_wit_Chemical_Process__c == 'Yes' && $Profile.Name=='Plant Manager Platform' && $User.Email==Incident_Record__c.Corporate_Environmental_Contact__c && $User.Email==Incident_Record__c.Corporate_Safety_Contact__c)}" title="Part I" columns="2">
<apex:outputField title="Entry where ACC Metric Calculated?" value="{!Incident_Record__c.Entry_ACC_Metric_Calculated__c}"/>
<apex:outputField title="Did the incident happen at a company operated facility?" value="{!Incident_Record__c.Incident_Happen_at_Company__c}"/>
<apex:outputField title="Was there Chemical Process Involvement?" value="{!Incident_Record__c.Chemical_Process_Involved__c}"/>
<apex:outputField title="Was the incident due to loss of primary containment of material?" value="{!Incident_Record__c.incidnt_due_to_loss_of_prmry_containmnt__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(Incident_Record__c.Type_of_Incident__c != null && Incident_Record__c.Incident_associated_wit_Chemical_Process__c == 'Yes' && $Profile.Name=='Plant Manager Platform' && $User.Email==Incident_Record__c.Corporate_Environmental_Contact__c && $User.Email==Incident_Record__c.Corporate_Safety_Contact__c)}" title="Part II" columns="2">
<apex:outputField title="Incident ACC reportable due to injury" value="{!Incident_Record__c.Incident_ACC_reportable_due_to_injury__c}"/>
<apex:outputField title="Incident ACC reportable due to fire / overpressure" value="{!Incident_Record__c.incident_ACC_reportable_due_to_Fire__c}"/>
<!--<apex:outputText label="Incident ACC reportable due to release" value="{!ACCrep}"/>-->
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(Incident_Record__c.Type_of_Incident__c != null && Incident_Record__c.Incident_associated_wit_Chemical_Process__c == 'Yes' && $Profile.Name=='Plant Manager Platform' && $User.Email==Incident_Record__c.Corporate_Environmental_Contact__c && $User.Email==Incident_Record__c.Corporate_Safety_Contact__c)}" title="ACC Process Safety Incident Metric Status" columns="2">
<apex:outputField title="Safety/Human Health " value="{!Incident_Record__c.Safety_Human_Health__c}"/>
<apex:outputField title="Fire/Explosion /Overpressure" value="{!Incident_Record__c.Fire_Explosion_Overpressure__c}"/>
<!--<apex:outputText label="Potential Chemical Impact" value="{!poten1}"/>-->
<apex:outputText label="Community / Environment Impact" value="{!Incident_Record__c.Community_Environment_Impact__c}"/>
<apex:outputField title="Safety/Human Health " value="{!Incident_Record__c.Safety_Human_Health_2__c}"/>
<apex:outputField title="Fire/Explosion /Overpressure" value="{!Incident_Record__c.Fire_Explosion_Overpressure_2__c}"/>
</apex:pageBlockSection>
<apex:pageBlockSection rendered="{!(Incident_Record__c.Type_of_Incident__c != null && Incident_Record__c.Incident_associated_wit_Chemical_Process__c == 'Yes' && $Profile.Name=='Plant Manager Platform' && $User.Email==Incident_Record__c.Corporate_Environmental_Contact__c && $User.Email==Incident_Record__c.Corporate_Safety_Contact__c)}" title="Additional Information Section" columns="2">
<apex:outputField title="ACC PSI Override" value="{!Incident_Record__c.ACC_PSI_Override__c}"/>
<apex:outputField title="Alternate Severity Level" value="{!Incident_Record__c.Alternate_Severity_Level__c}"/>
<apex:outputField title="Explanation" value="{!Incident_Record__c.Explanation__c}"/>
<apex:outputField title="Alternate Severity Score" value="{!Incident_Record__c.Alternate_Severity_Score__c}"/>
<apex:outputField title="Explanation Overriding  ACC PSI Score" value="{!Incident_Record__c.Explanation_Over__c}"/>
<apex:outputText label="Total" value="{!total}"/>
<apex:outputText label="Level" value="{!level}"/>

</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(value(Incident_Record__c.Status_Part__c) >= 2 && Incident_Record__c.Health_Effects__c!=null && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Release/Spill') && (CONTAINS(Incident_Record__c.Type_of_Release_Spill__c,'Federally/National/Provincial Reportable')||CONTAINS(Incident_Record__c.Type_of_Release_Spill__c,'Local / State / Region Reportable')))}" title="Incident Impact Score." columns="2">
<apex:outputField title="Health & Safety" value="{!Incident_Record__c.Health_Safety__c}"/>
<apex:outputField title="Environmental" value="{!Incident_Record__c.Environmental__c}"/>
<apex:outputField title="Facility Financial" value="{!Incident_Record__c.Facility_Financial__c}"/>
<apex:outputField title="Community" value="{!Incident_Record__c.Community__c}"/>
<apex:outputField title="Regulatory" value="{!Incident_Record__c.Regulatory__c}"/>
<apex:outputField title="Has an identical regulatory violation or reportable release occured within the last rolling 12-month period?" value="{!Incident_Record__c.Has_an_identical_regulatory_violation__c}"/>
<apex:outputField title="Is this the fourth (or more) regulatory violation within the same SHERA program (i.e., air, water, waste, other) -OR- externally reportable release within the last rolling 12-month period?" value="{!Incident_Record__c.Is_this_the_fourth_regulatory_violation__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!($Profile.Name=='Plant Manager Platform' &&value(Incident_Record__c.Status_Part__c) >= 2 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Injury/Illness/Just Reporting') && (Incident_Record__c.Classification_of_injury__c=='Medical Treatment beyond First Aid'||Incident_Record__c.Classification_of_injury__c=='Restricted Work'||Incident_Record__c.Classification_of_injury__c=='Days Away from Work'||Incident_Record__c.Classification_of_injury__c=='Death')&&Incident_Record__c.Site_RIM_Information__r.Country__c=='USA'&&(Incident_Record__c.Was_this_injury_to_a_Nexeo_Employee__c=='Yes'||Incident_Record__c.injured_person_under_our_direct_supervis__c=='Yes'))}" title="OSHA Form 301 Information-Information about the Employee" columns="2">
<apex:outputField title="Home Street Address" value="{!Incident_Record__c.Home_Street_Address__c}"/>
<apex:outputField title="Employee ID" value="{!Incident_Record__c.Employee_ID__c}"/>
<apex:outputField title="City" value="{!Incident_Record__c.City__c}"/>
<apex:outputField title="Zip Code" value="{!Incident_Record__c.Zip_Code__c}"/>
<apex:outputField title="State" value="{!Incident_Record__c.State__c}"/>
<apex:outputField title="Date of Birth" value="{!Incident_Record__c.Date_of_Birth__c}"/>
<apex:outputField title="Date Hired" value="{!Incident_Record__c.Date_Hired__c}"/>
<apex:outputField title="Male" value="{!Incident_Record__c.Male_Female__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!($Profile.Name=='Plant Manager Platform' &&value(Incident_Record__c.Status_Part__c) >= 2 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Injury/Illness/Just Reporting') && (Incident_Record__c.Classification_of_injury__c=='Medical Treatment beyond First Aid'||Incident_Record__c.Classification_of_injury__c=='Restricted Work'||Incident_Record__c.Classification_of_injury__c=='Days Away from Work'||Incident_Record__c.Classification_of_injury__c=='Death')&&Incident_Record__c.Site_RIM_Information__r.Country__c=='USA'&&(Incident_Record__c.Was_this_injury_to_a_Nexeo_Employee__c=='Yes'||Incident_Record__c.injured_person_under_our_direct_supervis__c=='Yes'))}" title="OSHA Form 301 Information-Information about the Physician" columns="2">
<apex:outputField title="treatment given away from the worksite?" value="{!Incident_Record__c.treatment_given_away_from_the_worksite__c}"/>
<apex:outputField title="Name of establishment" value="{!Incident_Record__c.Name_of_establishment__c}"/>
<apex:outputField title="Name of Physician or Health Care Profsnl" value="{!Incident_Record__c.Name_of_Physician_or_Health_Care_Profsnl__c}"/>
<apex:outputField title="Street Address" value="{!Incident_Record__c.Street_Address__c}"/>
<apex:outputField title="State-Physician" value="{!Incident_Record__c.State_Physician__c}"/>
<apex:outputField title="City of Physician" value="{!Incident_Record__c.City_of_Physician__c}"/>
<apex:outputField title="Zip Code-physician" value="{!Incident_Record__c.Zip_Code_physician__c}"/>
<apex:outputField title="employee treated in an emergency room?" value="{!Incident_Record__c.employee_treated_in_an_emergency_room__c}"/>
<apex:outputField title="employee hospitalized as an in-patient?" value="{!Incident_Record__c.employee_hospitalized_as_an_in_patient__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!($Profile.Name=='Plant Manager Platform'&& value(Incident_Record__c.Status_Part__c) >= 2 && CONTAINS(Incident_Record__c.Type_of_Incident__c,'Injury/Illness/Just Reporting') && (Incident_Record__c.Classification_of_injury__c=='Medical Treatment beyond First Aid'||Incident_Record__c.Classification_of_injury__c=='Restricted Work'||Incident_Record__c.Classification_of_injury__c=='Days Away from Work'||Incident_Record__c.Classification_of_injury__c=='Death')&&Incident_Record__c.Site_RIM_Information__r.Country__c=='USA'&&(Incident_Record__c.Was_this_injury_to_a_Nexeo_Employee__c=='Yes'||Incident_Record__c.injured_person_under_our_direct_supervis__c=='Yes'))}" title="OSHA Form 301 Information-Information about the case" columns="2">
<apex:form >
<apex:commandButton value="Open Blank OSHA" id="OSHAReport" onclick=" return OSHAReport();" reRender="pageDetails" />
<!--<apex:commandButton value="Export OSHA Form Report" id="ExportOSHAReport" onclick=" return ExportOSHAReport();" reRender="pageDetails" />-->
</apex:form>
<apex:outputField title="Time employee began" value="{!Incident_Record__c.Time_employee_began__c}"/>
<apex:outputField title="What happened?" value="{!Incident_Record__c.What_happened__c}"/>
<apex:outputField title="Wat emp was dng  bef the incidnt ocured?" value="{!Incident_Record__c.Wat_emp_was_dng_bef_the_incidnt_ocured__c}"/>
<apex:outputField title="What was the injury or illness?" value="{!Incident_Record__c.What_was_the_injury_or_illness__c}"/>
<apex:outputField title="What object/substance harmed employee?" value="{!Incident_Record__c.What_object_substance_harmed_employee__c}"/>
<apex:outputField title="Telephone number of person" value="{!Incident_Record__c.Telephone_number_of_person__c}"/>
<apex:outputField title="Date OSHA" value="{!Incident_Record__c.Date_OSHA__c}"/>
<apex:outputField title="If  employee died, date of death occurd?" value="{!Incident_Record__c.If_employee_died_date_of_death_occurd__c}"/>
<apex:outputField title="Completed By" value="{!Incident_Record__c.Completed_By__c}"/>
<apex:outputField title="Title of person" value="{!Incident_Record__c.Title_of_person__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(Incident_Record__c.Type_of_Incident__c != null && Incident_Record__c.equipment_involved_in_the_incident__c!=null && value(Incident_Record__c.Status_Part__c) >= 3.5)}" title="Root Cause Analysis / Corrective-Preventive Actions" columns="2">
<apex:outputField title="equipment involved in the incident" value="{!Incident_Record__c.equipment_involved_in_the_incident__c}"/>
<apex:outputField title="Specify Other Equipment" value="{!Incident_Record__c.Specify_Other_Equipment__c}" rendered="{!Incident_Record__c.equipment_involved_in_the_incident__c=='Other'}"/>
<apex:outputField title="Major Root Cause Categories" value="{!Incident_Record__c.Major_Root_Cause_Categories__c}"/>
<apex:outputField title="Associated Root Causes" value="{!Incident_Record__c.Associated_Root_Causes__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(value(Incident_Record__c.Status_Part__c) >= 4 && Incident_Record__c.Investigation_Prevents_Future_incident__c!=null && (CONTAINS(Incident_Record__c.Type_of_Incident__c,'Release/Spill') || CONTAINS(Incident_Record__c.Type_of_Incident__c,'Fire/Explosion/OverPressure') || CONTAINS(Incident_Record__c.Type_of_Incident__c,'Injury/Illness/Just Reporting') || CONTAINS(Incident_Record__c.Type_of_Incident__c,'Non Conformance/Violation') || CONTAINS(Incident_Record__c.Type_of_Incident__c,'Security')))}" title="Final Report / Plan Approval Information" columns="2">
<apex:outputField title="Investigation Prevents Future incident?" value="{!Incident_Record__c.Investigation_Prevents_Future_incident__c}"/>
<apex:outputField title="target date" value="{!Incident_Record__c.target_date__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(Incident_Record__c.Type_of_Incident__c != null && Incident_Record__c.All_actions_to_this_Incident_Complete__c!=null &&  value(Incident_Record__c.Status_Part__c) >= 5)}" title="Final Report Closing Information" columns="2">
<apex:outputField title="All actions to this Incident Complete?" value="{!Incident_Record__c.All_actions_to_this_Incident_Complete__c}"/>
<apex:outputField title="Cost information below final/actual amt?" value="{!Incident_Record__c.Cost_information_below_final_actual_amt__c}"/>
<apex:outputField title="Necessary information been entered?" value="{!Incident_Record__c.Necessary_information_been_entered__c}"/>
<apex:outputField title="Any Additional Info / Description" value="{!Incident_Record__c.Any_Additional_Info_Description__c}"/>
<apex:outputField title="Incident appropriately resolved?" value="{!Incident_Record__c.Incident_appropriately_resolved__c}"/>
<apex:outputField title="Actual Approval Date" value="{!Incident_Record__c.Actual_Approval_Date__c}"/>
<apex:outputField title="Report Approved by" value="{!Incident_Record__c.Report_Approved_by__c}"/>
<apex:outputField title="What is the total cost of the incident?" value="{!Incident_Record__c.What_is_the_total_cost_of_the_incident__c}"/>
<apex:outputField title="Cost of the incident > $2,500 USD?" value="{!Incident_Record__c.Cost_of_the_incident_2_500_USD__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(Incident_Record__c.Type_of_Incident__c != null && Incident_Record__c.Equipment_Damage_Costs_due_to_Incident__c!=null && value(Incident_Record__c.Status_Part__c) >= 5)}" title="Estimated Final Incident Costs" columns="2">
<apex:outputField title="Equipment Damage Costs due to Incident" value="{!Incident_Record__c.Equipment_Damage_Costs_due_to_Incident__c}"/>
<apex:outputField title="Workers compensation case number" value="{!Incident_Record__c.Workers_compensation_case_number__c}"/>
<apex:outputField title="Material  Loss Costs due to incident" value="{!Incident_Record__c.Material_Loss_Costs_due_to_incident__c}"/>
<!--<apex:outputField title="Enter year penalty was settled" value="{!Incident_Record__c.Enter_year_penalty_was_settled__c}"/>-->
<apex:outputField title="OutofPocket Cost for Business Interrupt" value="{!Incident_Record__c.OutofPocket_Cost_for_Business_Interrupt__c}"/>
<apex:outputField title="Costs be recovered from another party?" value="{!Incident_Record__c.Costs_be_recovered_from_another_party__c}"/>
<apex:outputField title="Additional Labor Cost due to Incident" value="{!Incident_Record__c.Additional_Labor_Cost_due_to_Incident__c}"/>
<apex:outputField title="Explain What Costs are to be Recovered" value="{!Incident_Record__c.Explain_What_Costs_are_to_be_Recovered__c}"/>
<apex:outputField title="Cleanup/Treatment Costs" value="{!Incident_Record__c.Cleanup_Treatment_Costs__c}"/>
<apex:outputField title="Penalty/Fines" value="{!Incident_Record__c.Penalty_Fines__c}"/>
<apex:outputField title="Preventive Action Costs" value="{!Incident_Record__c.Preventive_Action_Costs__c}"/>
<apex:outputField title="Costs to  Repair/etc Non-Ashland Assets" value="{!Incident_Record__c.Costs_to_Repair_etc_Non_Ashland_Assets__c}"/>
<apex:outputField title="Misc /Other Costs" value="{!Incident_Record__c.Misc_Other_Costs__c}"/>
<!--<apex:outputField title="Workers Comp Costs including Reserved" value="{!Incident_Record__c.Workers_Comp_Costs_including_Reserved__c}"/>-->
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(0==0 && (CONTAINS(Incident_Record__c.Type_of_Release_Spill__c,'Federally/National/Provincial Reportable')||CONTAINS(Incident_Record__c.Type_of_Release_Spill__c,'Local / State / Region Reportable')) && value(Incident_Record__c.Status_Part__c) >= 3.5)}" title="Corporate Environmental Approval" columns="2">
<apex:outputField title="Approval Status" value="{!Incident_Record__c.Approval_Status__c}"/>
<apex:outputField title="Approved By" value="{!Incident_Record__c.Approved_By__c}"/>
<apex:outputField title="Date Approved" value="{!Incident_Record__c.Date_Approved__c}"/>
<apex:outputField title="Comments" value="{!Incident_Record__c.Comments__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!(Incident_Record__c.Type_of_Incident__c != null && Incident_Record__c.Describe_offsite_emergency_response__c!=null && value(Incident_Record__c.Status_Part__c) >= 2)}" title="Site Information" columns="2">
<apex:outputField title="SIC / NAICS" value="{!Incident_Record__c.SIC_NAICS__c}"/>
<apex:outputField title="Site RIM Information" value="{!Incident_Record__c.Site_RIM_Information__c}"/>
<apex:outputField title="Site RIM Information" rendered="false" value="{!Incident_Record__c.Site_RIM_Country__c}"/>
<!--<apex:outputField title="EIM Rank" value="{!Incident_Record__c.Estimated Final Incident Costs}"/>-->
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!$User.Email=='ejriley@nexeosolutions.com'}" title="Record Properties" columns="2">
<apex:outputField title="AdjustedRCAIncidentDate" value="{!Incident_Record__c.AdjustedRCAIncidentDate__c}"/>
<apex:outputField title="RCADate" value="{!Incident_Record__c.RCADate__c}"/>
<apex:outputField title="MainMajorProblemOverride" value="{!Incident_Record__c.MainMajorProblemOverride__c}"/>
<apex:outputField title="RCAComment" value="{!Incident_Record__c.RCAComment__c}"/>
<apex:outputField title="LockEIM should have a note" value="{!Incident_Record__c.LockEIM_should_have_a_note__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!$User.Email=='ejriley@nexeosolutions.com'}" title="Incident Type CalculatedValues" columns="2">
<apex:outputField title="ActionRequired" value="{!Incident_Record__c.ActionRequired__c}"/>
<apex:outputText label="Action Required Owner" rendered="{!Incident_Record__c.Status_Part__c=='2'}">{!PersonswhotranslateName},Edward Riley</apex:outputText>
<apex:outputText label="Action Required Owner" rendered="{!value(Incident_Record__c.Status_Part__c)>=3.5 && Incident_Record__c.Is_Root_Cause_to_be_performed__c=='Yes' && NOT(CONTAINS(Incident_Record__c.Edit_History_Status__c,'Completed RCA Approval'))}">{!performRootCauseAnalysisName},Edward Riley</apex:outputText>
<apex:outputText label="Action Required Owner" rendered="{!Incident_Record__c.Status_part_info__c=='Requires Final Report/ Plan Approval'}">{!Incident_Record__c.Report_Plan_Approver_follow_up__r.Name},Edward Riley</apex:outputText>
<apex:outputText label="Action Required Owner for Corporate Notification Sendoff" rendered="{!Incident_Record__c.Status_part_info2__c=='Requires Corporate Notification Sendoff (First Report)' && value(Incident_Record__c.Status_Part__c)>=2}">{!Incident_Record__c.Select_Person_For_Follow_Up__r.Name},{!Incident_Record__c.Report_Plan_Approver__r.Name},Edward Riley</apex:outputText>
<apex:outputText label="Action Required Owner" rendered="{!Incident_Record__c.Status_part_info__c=='Requires Final Report Closure'}">{!finalizecloseincidentsName},Edward Riley</apex:outputText>
<apex:outputField title="Is Root Cause to be performed?" value="{!Incident_Record__c.Is_Root_Cause_to_be_performed1__c}"/>
<apex:outputField title="ShortCircuit" value="{!Incident_Record__c.ShortCircuit__c}"/>
<apex:outputField title="Priority OverRide" value="{!Incident_Record__c.Priority_OverRide__c}"/>
<apex:outputField title="Priority Explaination" value="{!Incident_Record__c.Priority_Explaination_part1__c}"/>
<apex:outputField title="Priority Override Description" value="{!Incident_Record__c.Priority_Override_Description__c}"/>
<!--<apex:inlineEditSupport event="ondblClick"  showOnEdit="saveButton,cancelButton" hideOnEdit="editButton,SentButton,SubmitIncident,AppIniInc,AppRootCau,AppFinalRep,CorNotiSend,AppFinRe,CorEnvApp,CorEnvRej,CorEnvReSub,AddRelIncid" /> -->
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!$User.Email=='ejriley@nexeosolutions.com'}" title="Approvals subsection" columns="2">
<apex:outputField title="Part2Approval" value="{!Incident_Record__c.Part2Approval__c}"/>
<apex:outputField title="Part3.5Approval(Obsolete- do not remove)" value="{!Incident_Record__c.Part3_5Approval__c}"/>
<apex:outputField title="Part3Approval" value="{!Incident_Record__c.Part3Approval__c}"/>
<apex:outputField title="CorpEnvApproved" value="{!Incident_Record__c.CorpEnvApproved__c}"/>
<apex:outputField title="Part3ApprovalDoneFirst" value="{!Incident_Record__c.Part3ApprovalDoneFirst__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!$User.Email=='ejriley@nexeosolutions.com'}" title="Notification Flags" columns="2">
<apex:outputField title="RCANotification" value="{!Incident_Record__c.RCANotification__c}"/>
<apex:outputField title="NotifyEmergResp" value="{!Incident_Record__c.NotifyEmergResp__c}"/>
<apex:outputField title="CorporateNotified" value="{!Incident_Record__c.CorporateNotified__c}"/>
<apex:outputField title="Part5Notified" value="{!Incident_Record__c.Part5Notified__c}"/>
<apex:outputField title="NotifyLawDept" value="{!Incident_Record__c.NotifyLawDept__c}"/>
<apex:outputField title="FireImpairmentNotified" value="{!Incident_Record__c.FireImpairmentNotified__c}"/>
</apex:pageBlockSection>

<apex:pageBlockSection rendered="{!$User.Email=='ejriley@nexeosolutions.com'}" title="Relibility Incident Follow Up Section" columns="2">
<apex:outputField title="Reliability Failure Codes" value="{!Incident_Record__c.Reliability_Failure_Codes__c}"/>
<apex:outputField title="Reliability Process Area" value="{!Incident_Record__c.Reliability_Process_Area__c}"/>
<apex:outputField title="Reliability Equipment Type" value="{!Incident_Record__c.Reliability_Equipment_Type__c}"/>
<apex:outputField title="Functional Location" value="{!Incident_Record__c.Functional_Location__c}"/>
<apex:outputField label="select Relibility Contact Name" value="{!Incident_Record__c.Relibility_Contact_Name__c}"/>
</apex:pageBlockSection>
<apex:outputpanel id="sec4">
<apex:pageBlockSection title="Edit History Notes"  columns="1">
<apex:outputText id="createdbyemail" rendered="false">{!Incident_Record__c.CreatedBy.Email}</apex:outputText>
<apex:outputpanel style="font-family:Times New Roman,Georgia,Serif;font-size:1.2em;color:#168FB6;font-weight: bold" >
<apex:outputtext escape="false" value="{!Incident_Record__c.Edit_History_Status__c}"/>
</apex:outputpanel>
</apex:pageBlockSection>
</apex:outputpanel>

</apex:pageBlock>

<apex:relatedList list="NotesAndAttachments" />

<apex:relatedList list="Incident_Procedure_Records__r"/>
</apex:page>